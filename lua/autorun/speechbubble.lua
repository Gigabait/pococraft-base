////////////////////////////////////   Speech Bubble              ////                 ZEST STUDIO  ////////////////////////////////////if (SERVER) then	util.AddNetworkString("Network_Talk")endif (CLIENT) then	for i = 10, 64 do	 surface.CreateFont("Font_"..i, {font = "Tahoma", size = i, weight = 500, antialias = true})	 surface.CreateFont("FontBold_"..i, {font = "Tahoma", size = i, weight = 600, antialias = true})	 surface.CreateFont("FontBlur_"..i, {font = "Tahoma", size = i, weight = 600, antialias = true, shadow = true, blursize = 1})	end	local function CanTraceToPlayer(ply)	 local tr = {}	  tr.start = LocalPlayer():EyePos()	  tr.endpos = ply:GetPos() + Vector(0, 0, 40)	  tr.filter = {LocalPlayer(), ply:GetWeapons()}	  tr.mask = MASK_SOLID - CONTENTS_GRATE	  tr = util.TraceLine(tr) 	  	 if (tr.Entity) == ply then	  return true	 else	  return false	 end	end	hook.Add( "OnPlayerChat", "speechb", function( ply, strText, bTeamOnly, bPlayerIsDead )		ply.ChatData = ply.ChatData or {} 		local data = {			ply = ply,			text = strText,			time = CurTime() + 3,			time_a = CurTime() + 3.5,			rand = math.random(4,5),			r = math.random(100,150),			g = math.random(100,150),			b = math.random(100,150),			y = 0,			ty = 0,			a = 0,			ta = 255		}		surface.PlaySound("common/talk.wav")		table.insert(ply.ChatData, data)	end)	hook.Add( "HUDPaint", "speechbe", function()		for _,ply in pairs(player.GetAll()) do			local Dist = 500			if ply == LocalPlayer() then continue end			if !CanTraceToPlayer(ply) then continue end			if LocalPlayer():GetPos():Distance(ply:GetPos()) >= Dist then continue end			for k,v in pairs(table.Reverse(ply.ChatData or {})) do				if v.time <= CurTime() then					v.ta = 0				end				if v.time_a <= CurTime() then					local ta = table.Reverse(ply.ChatData or {})					table.remove(ta, k)					ply.ChatData = table.Reverse(ta or {})				end				local pos = ply:GetPos() + Vector(0,0,70 + math.cos(CurTime()*v.rand) * 2)				local tpos = pos:ToScreen()				local round = 4				v.ty = k * 60				v.y = Lerp(0.05, v.y, v.ty)				v.a = Lerp(0.05, v.a, v.ta)				surface.SetFont("FontBold_20")				Width, Height = surface.GetTextSize(v.text)				local tx,ty = tpos.x, tpos.y - v.y				local kx,ky = -5, 32				surface.SetDrawColor( v.r, v.g, v.b, v.a )				draw.NoTexture()				draw.RoundedBox(round, tpos.x - Width / 2 - 10 - 3, tpos.y - v.y - Height / 2 - 3, Width + 20 + 6, Height + 15 + 6, Color(v.r,v.g,v.b,v.a))				draw.RoundedBox(round, tpos.x - Width / 2 - 10, tpos.y - v.y - Height / 2, Width + 20, Height + 15, Color(255,255,255,v.a))				for i = 1, 3 do					draw.SimpleText(v.text, "FontBlur_20", tpos.x, tpos.y - v.y - 5, Color(v.r,v.g,v.b,v.a), 1)				end				draw.SimpleText(v.text, "FontBold_20", tpos.x, tpos.y - v.y - 5, Color(255,255,255,v.a), 1)			end		end	end)end